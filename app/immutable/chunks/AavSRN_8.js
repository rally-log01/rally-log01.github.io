import{d as b,w as g}from"./Bj3Ywu8e.js";import{A as I}from"./CFPkIEmq.js";var n=(e=>(e.UnAuthenticated="un-authenticated",e.Authenticated="authenticated",e.Admin="admin",e.Root="root",e))(n||{});const l={username:"User",role:n.UnAuthenticated},y={username:"Admin",role:n.Admin},A={username:"Root",role:n.Root},O=[{label:"Home",url:"/home",roles:[n.UnAuthenticated,n.Authenticated,n.Admin,n.Root],index:1}];function w(e){const i=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&i==="[object Date]"?new e.constructor(+e):typeof e=="number"||i==="[object Number]"||typeof e=="string"||i==="[object String]"?new Date(e):new Date(NaN)}function k(e){return w(e).getDay()===0}const j=()=>{const{stores:{currentUser:e},actions:{init:i}}=T();i();const a=I(e);let t=[];t=[...t,...O];const m=(o,c)=>o&&o.find(f=>f.role===c)?.sundayOnly?k(new Date):!0;return t.filter(o=>{const c=a.role,h=!!o.roles.find(p=>p===c),f=m(o.visibilities,c);return h&&f}).sort((o,c)=>o.index-c.index)};async function U(e){function i(o){return Array.from(new Uint8Array(o)).map(c=>c.toString(16).padStart(2,"0")).join("")}const t=new TextEncoder().encode(e),m=await crypto.subtle.digest("SHA-256",t);return i(m)}let u=null;const N=()=>{const e=g(!1),i=g("Home"),a=g(!1),t=g(l),m=b([t],([r])=>r.role===n.Admin||r.role===n.Root),o=b([t],([r])=>r.role===n.Admin),c=b([t],([r])=>r.role===n.Root);return u={stores:{darkTheme:e,pageName:i,authenticated:a,currentUser:t,currentUserIsAdmin:o,currentUserIsRoot:c,currentUserIsRootOrAdmin:m},actions:{init:()=>{const r=localStorage.getItem("theme"),s=r??"light";e.set(r==="dark"),document.documentElement.setAttribute("data-bs-theme",s),localStorage.setItem("theme",s);const d=localStorage.getItem("currentUser"),S=d?JSON.parse(d):l;switch(t.set(S),localStorage.setItem("currentUser",JSON.stringify(S)),S.username){case y.username:case A.username:a.set(!0);break;case l.username:default:a.set(!1)}},toggleTheme:()=>{const r=localStorage.getItem("theme");let s="light";r==="light"&&(s="dark"),e.set(s==="dark"),document.documentElement.setAttribute("data-bs-theme",s),localStorage.setItem("theme",s)},login:async(r,s)=>{const d=r.toLowerCase().trim();return console.log("password",await U(s)),d==="admin"&&await U(s)==="2566c0e434cf6099613dc50de36e61f0503272c3ed76e699fcbb3ff9c7b9713c"?(t.set(y),a.set(!0),localStorage.setItem("currentUser",JSON.stringify(y)),!0):d==="root"&&await U(s)==="2566c0e434cf6099613dc50de36e61f0503272c3ed76e699fcbb3ff9c7b9713c"?(t.set(A),a.set(!0),localStorage.setItem("currentUser",JSON.stringify(A)),!0):(localStorage.setItem("currentUser",JSON.stringify(l)),t.set(l),a.set(!1),!1)},logout:()=>{a.set(!1),localStorage.setItem("currentUser",JSON.stringify(l)),t.set(l)}}},u},T=()=>u?.stores&&Object.keys(u.stores).length>0&&u?.actions&&Object.keys(u.actions).length>0?u:N();export{n as U,j as a,T as g};
