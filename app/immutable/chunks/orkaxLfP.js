import{d as b,w as h}from"./3Nn_4NU5.js";import{z as R}from"./CQU11sYc.js";var e=(t=>(t.UnAuthenticated="un-authenticated",t.Authenticated="authenticated",t.Admin="admin",t.Root="root",t))(e||{});const l={username:"User",role:e.UnAuthenticated},S={username:"Admin",role:e.Admin},y={username:"Root",role:e.Root},I=[{label:"Dashboard",url:"/dashboard",roles:[e.UnAuthenticated,e.Authenticated,e.Admin,e.Root],index:1},{label:"Tournaments",url:"/tournaments",roles:[e.UnAuthenticated,e.Authenticated,e.Admin,e.Root],index:2},{label:"Players",url:"/players",roles:[e.UnAuthenticated,e.Authenticated,e.Admin,e.Root],index:3},{label:"Matches",url:"/matches",roles:[e.UnAuthenticated,e.Authenticated,e.Admin,e.Root],index:4},{label:"Statistics",url:"/stats",roles:[e.UnAuthenticated,e.Authenticated,e.Admin,e.Root],index:5}];function T(t){const i=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&i==="[object Date]"?new t.constructor(+t):typeof t=="number"||i==="[object Number]"||typeof t=="string"||i==="[object String]"?new Date(t):new Date(NaN)}function w(t){return T(t).getDay()===0}const E=()=>{const{stores:{currentUser:t},actions:{init:i}}=O();i();const s=R(t);let r=[];r=[...r,...I];const u=(o,a)=>o&&o.find(f=>f.role===a)?.sundayOnly?w(new Date):!0;return r.filter(o=>{const a=s.role,g=!!o.roles.find(U=>U===a),f=u(o.visibilities,a);return g&&f}).sort((o,a)=>o.index-a.index)};async function p(t){function i(o){return Array.from(new Uint8Array(o)).map(a=>a.toString(16).padStart(2,"0")).join("")}const r=new TextEncoder().encode(t),u=await crypto.subtle.digest("SHA-256",r);return i(u)}let m=null;const N=()=>{const t=h(!0),i=h("Home"),s=h(!1),r=h(l),u=b([r],([n])=>n.role===e.Admin||n.role===e.Root),o=b([r],([n])=>n.role===e.Admin),a=b([r],([n])=>n.role===e.Root);return m={stores:{darkTheme:t,pageName:i,authenticated:s,currentUser:r,currentUserIsAdmin:o,currentUserIsRoot:a,currentUserIsRootOrAdmin:u},actions:{init:()=>{const n=localStorage.getItem("theme"),c=n??"dark";t.set(n==="dark"),document.documentElement.setAttribute("data-bs-theme",c),localStorage.setItem("theme",c);const d=localStorage.getItem("currentUser"),A=d?JSON.parse(d):l;switch(r.set(A),localStorage.setItem("currentUser",JSON.stringify(A)),A.username){case S.username:case y.username:s.set(!0);break;case l.username:default:s.set(!1)}},toggleTheme:()=>{const n=localStorage.getItem("theme");let c="light";n==="light"&&(c="dark"),t.set(c==="dark"),document.documentElement.setAttribute("data-bs-theme",c),localStorage.setItem("theme",c)},login:async(n,c)=>{const d=n.toLowerCase().trim();return d==="admin"&&await p(c)==="2566c0e434cf6099613dc50de36e61f0503272c3ed76e699fcbb3ff9c7b9713c"?(r.set(S),s.set(!0),localStorage.setItem("currentUser",JSON.stringify(S)),!0):d==="root"&&await p(c)==="2566c0e434cf6099613dc50de36e61f0503272c3ed76e699fcbb3ff9c7b9713c"?(r.set(y),s.set(!0),localStorage.setItem("currentUser",JSON.stringify(y)),!0):(localStorage.setItem("currentUser",JSON.stringify(l)),r.set(l),s.set(!1),!1)},logout:()=>{s.set(!1),localStorage.setItem("currentUser",JSON.stringify(l)),r.set(l)}}},m},O=()=>(m||(m=N()),m);export{e as U,E as a,O as g};
