import{w as d,d as y}from"./3Nn_4NU5.js";import{s}from"./Bd48NFI8.js";import{z as w}from"./CQU11sYc.js";const f=d([]);let m=!1;async function c(){if(m)return w(f);m=!0;const{data:t,error:e}=await s.from("tournaments").select("*").order("name",{ascending:!0});if(e)throw e;const r=t||[];return f.set(r),setTimeout(()=>m=!1,800),r}async function h(t){const{data:e,error:r}=await s.from("tournaments").insert([t]).select();if(r)throw r;return await c(),e[0]}async function p(t,e){const{error:r}=await s.from("tournaments").update(e).eq("id",t);if(r)throw r;await c();const u=w(f).find(l=>l.id===t);return u||void 0}async function g(t){const{error:e}=await s.from("tournaments").delete().eq("id",t);if(e)throw e;await c()}let o=null;const v=()=>{const t=d([]),e=d(void 0),r=y([t,e],([n,a])=>{if(n?.length&&a)return n.find(i=>i.id===a)});return o={stores:{data:t,currentTournamentId:e,currentTournament:r},actions:{reload:async()=>{const n=await c();t.set(n)},createTournament:async n=>{try{await h(n)}catch(a){console.error(a)}},updateTournament:async(n,a)=>{try{await p(n,a)}catch(i){console.error(i)}},deleteTournament:async n=>{try{await g(n)}catch(a){console.error(a)}}}},o},S=()=>(o||(o=v()),o);export{S as g};
