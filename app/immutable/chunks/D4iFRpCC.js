import{w as d,d as p}from"./3Nn_4NU5.js";import{s as n}from"./Bd48NFI8.js";import{z as w}from"./CQU11sYc.js";const f=d([]);let y=!1;async function c(){if(y)return w(f);y=!0;const{data:e,error:t}=await n.from("players").select("*").order("name",{ascending:!0});if(t)throw t;const r=e||[];return f.set(r),setTimeout(()=>y=!1,800),r}async function m(e){const{data:t,error:r}=await n.from("players").insert([e]).select();if(r)throw r;return await c(),t[0]}async function h(e,t){const{error:r}=await n.from("players").update(t).eq("id",e);if(r)throw r;await c();const l=w(f).find(u=>u.id===e);return l||void 0}async function g(e){const{error:t}=await n.from("players").delete().eq("id",e);if(t)throw t;await c()}let s=null;const v=()=>{const e=d([]),t=d(void 0),r=p([e,t],([a,o])=>{if(a?.length&&o)return a.find(i=>i.id===o)});return s={stores:{data:e,currentPlayerId:t,currentPlayer:r},actions:{reload:async()=>{const a=await c();e.set(a)},createPlayer:async a=>{try{await m(a)}catch(o){console.error(o)}},updatePlayer:async(a,o)=>{try{await h(a,o)}catch(i){console.error(i)}},deletePlayer:async a=>{try{await g(a)}catch(o){console.error(o)}}}},s},S=()=>(s||(s=v()),s);export{S as g};
